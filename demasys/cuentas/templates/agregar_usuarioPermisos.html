{% extends 'base.html' %}
{% load i18n %}
{% load sepomex_filters %}
{% load url from future %}
{% load bootstrap_pagination %}

{% block title %}Subir Exel{% endblock %}
{% block content_title %} Permisos Usuarios{% endblock %}

{% block extra_head %}
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}plugins/bootstrap-datepicker/css/datepicker3.css"/>
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}plugins/select2/select2.css"/>
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}plugins/jquery-multi-select/css/multi-select.css"/>

{% endblock %}




{% block nav-viajes %}<li class="active">{% endblock %}

{% block breadcrumb %}
<ul class="page-breadcrumb">
	<li>
		<i class="fa fa-home"></i>
		<a href="{% url 'dashboards.views.index' %}">Dashboard</a>    
		<i class="fa fa-angle-right"></i>                    
	</li>
	<i class="icon-rocket"></i>
	<li>        
		Usuarios
		<i class="fa fa-angle-right"></i>                        
	</li>
	<li>        
		Permisos Usuarios                        
	</li>    
</ul>
{% endblock %}

{% block actions %}
{% endblock %}

{% block content %}


<!--aquiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii-->
<div class="modal fade" id="ajax" role="basic" aria-hidden="true">
	<div class="page-loading page-loading-boxed">
		<img src="{{MEDIA_URL}}img/loading-spinner-grey.gif" alt="" class="loading">
		<span>
			&nbsp;&nbsp;Cargando... </span>
		</div>
		<div class="modal-dialog">
			<div class="modal-content">
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="portlet light bg-inverse form-fit">
				<div class="portlet-title">
					<div class="caption">
						<i class="icon-equalizer font-blue"></i>
						<span class="caption-subject font-blue bold uppercase">{{action}} Usuarios</span>											
					</div>										
				</div>
				<div class="portlet-body form">
					<!-- BEGIN FORM-->
					<form action="" class="form-horizontal form-row-seperated" method="post" name="f1">
						{% csrf_token %}
						<div class="form-body">												
							<h3 class="form-section">Datos Usuario</h3>
							<div>
								<label class="control-label col-md-3"></label>
								<div class="col-md-9">
									<input type="hidden" value="" id="llave" name="llave"/>


								</div>
							</div>
							<div class="form-group {% if form.tipo_ruta.errors %}has-error{% endif %}">
								<label class="control-label col-md-3">Usuario<span class="required" aria-required="true"> * </span></label>
								<div class="col-md-9">
									{{formPriv.user}}
									{% if form.tipo_ruta.errors %}<span class="help-block">{{form.tipo_ruta.errors}}</span>{% endif %}
								</div>
							</div>
							<div class="form-group">
								<label class="control-label col-md-3">Todos los privilegios<span class="required" aria-required="true"> * </span></label>
								<div class="col-md-9">
									<input type="checkbox" id="todosPriv"  
									disabled="true" name="todosPriv"/>
								</div>
							</div>												
							<h3>Módulos de Acceso</h3>
							<!--arbol-->
							<div class="navbar-collapse collapse" >
								<ul class="page-sidebar-menu " data-auto-scroll="true" data-slide-speed="200">				
									{% block nav-dashboard %}<li class="start ">{% endblock %}
									<a href="javascript:;">
										<i class="icon-home"></i>
										<span class="title">Dashboard</span>
									</a>					
								</li>
								{% block nav-catalogos %}<li>{% endblock %}
								<a href="javascript:;">
									<i class="icon-settings"></i>
									<span class="title">Catalogos</span>
									<span class="arrow "></span>
								</a>
								<ul class="sub-menu">
									{% block nav-modeconomicos %}<li>{% endblock %}
									<a href="javascript:;">
										Modelos de Economicos</a>
									<div class="row form-group">	
									<div class="col-md-1">	
										Agregar {{formPriv.catModEco_A}}
									</div>	
									<div class="col-md-1">	
										Editar {{formPriv.catModEco_M}}
									</div>
									<div class="col-md-1">
										Eliminar {{formPriv.catModEco_B}}
									</div>	
									</div>	



									</li>							
									{% block nav-economicos %}<li>{% endblock %}
									<a href="javascript:;">
										Economicos</a>

									</li>
									{% block nav-operadores %}<li>{% endblock %}
									<a href="javascript:;">
										Operadores</a>

									</li>
									{% block nav-casetas %}<li>{% endblock %}
									<a href="javascript:;">
										Casetas</a>

									</li>
									{% block nav-gastos %}<li>{% endblock %}
									<a href="javascript:;">
										Gastos</a>

									</li>		
									{% block nav-factconceptos %}<li>{% endblock %}
									<a href="javascript:;">
										Conceptos facturación</a>

									</li>	
								</ul>
							</li>
							{% block nav-rutas %}<li>{% endblock %}
							<a href="{% url 'viajes.views.rutas' %}">
								<i class="icon-pointer"></i>
								<span class="title">Rutas</span>					
							</a>					
						</li>
						{% block nav-clientes %}<li>{% endblock %}
						<a href="{% url 'clientes.views.index' %}">
							<i class="icon-briefcase"></i>
							<span class="title">Clientes</span>					
						</a>					
					</li>
					{% block nav-usuarios %}<li>{% endblock %}
					<a href="javascript:''">
						<i class="icon-user"></i>
						<span class="title">Usuarios</span>					
						<span class="arrow "></span>
					</a>
					<ul class="sub-menu">
						{% block catUsr %}<li>{% endblock %}
						<a href="{% url 'cuentas.views.usuarios' %}">
							Catálogo Usuarios</a>
						</li>                            
						{% block privUsr %}<li>{% endblock %}
						<a href="{% url 'cuentas.views.usuariosprivilegios' %}">
							Privilegios</a>
						</li>                            
					</ul>
				</li>
				{% block nav-viajesx %}<li>{% endblock %}
				<a href="javascript:;">
					<i class="icon-rocket"></i>
					<span class="title">Viajes</span>
					<span class="arrow "></span>					
				</a>
				<ul class="sub-menu">
					{% block nav-Rep_rep %}<li>{% endblock %}
					<a href="{% url 'viajes.views.reportes' %}">
						Generador de Reportes</a>
					</li>                            
					{% block nav-Rep_exel %}<li>{% endblock %}
					<a href="{% url 'viajes.views.subirExcel' %}">
						Subir Archivo Excel</a>
					</li>                            
				</ul>					
			</li>
			{% comment %}
			{% block nav-reportes %}<li>{% endblock %}
			<a href="javascript:;">
				<i class="icon-layers"></i>
				<span class="title">Reportes</span>    
				<span class="arrow "></span>                
			</a>
			<ul class="sub-menu">
				{% block nav-Rep_rep %}<li>{% endblock %}
				<a href="{% url 'viajes.views.reportes' %}">
					Generador de Reportes</a>
				</li>                            
				{% block nav-Rep_exel %}<li>{% endblock %}
				<a href="{% url 'viajes.views.subirExcel' %}">
					Subir Archivo Excel</a>
				</li>                            
			</ul>                                        
		</li>
		{% endcomment %}

		{% block nav-Lista_Sol %}<li>{% endblock %}
		<a href="javascript:;">
			<i class="icon-puzzle"></i>
			<span class="title">Solicitudes</span>
			<span class="arrow "></span>
		</a>
		<ul class="sub-menu">
			{% block nav-Sol_Sol %}<li>{% endblock %}
			<a href="{% url 'solicitudes.views.index' %}">
				Registro de Solicitudes</a>
			</li>							
			{% block nav-Sol_Bene %}<li>{% endblock %}
			<a href="{% url 'beneficiarios.views.index' %}">
				Beneficiarios</a>
			</li>
			{% block nav-Sol_Concep %}<li>{% endblock %}
			<a href="{% url 'solicitudes.views.index_con' %}">
				Conceptos</a>
			</li>
			{% block nav-Sol_Report %}<li>{% endblock %}
			<a href="{% url 'solicitudes.views.reporte_sol' %}">
				Reporte de Solicitudes</a>
			</li>
		</ul>
		<div class="form-actions">
			<div class="row">
				<div class="col-md-offset-3 col-md-9">
					<button type="submit" class="btn blue"><i class="fa fa-pencil"></i> {{action}}</button>														
				</div>
			</div>
		</div>
	</div>
	<!--fin arbol-->												





</div>

</form>
<!-- END FORM-->
</div>
</div>
</div>
</div>
{% endblock %}
{% block extra_script %}
<script type="text/javascript" src="{{MEDIA_URL}}plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}plugins/select2/select2.js"></script>
<script src="{{MEDIA_URL}}plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
<script type="text/javascript" src="{{MEDIA_URL}}plugins/jquery-multi-select/js/jquery.multi-select.js"></script>



{% endblock %}
{% block script_ready %}
$("#uniform-todosPriv").removeClass("checker");
$("#uniform-id_catModEco_A").removeClass("checker");
$("#uniform-id_catModEco_B").removeClass("checker");
$("#uniform-id_catModEco_M").removeClass("checker");


$('#todosPriv').bind('change', function () {

   if ($(this).is(':checked')){
     seleccionar_todo();
   }else{
     window.location.href=window.location.href;
}
});


$("#id_user").change(function(){
var pk=$("#id_user").val();  
$("#llave").val(pk);

          
	  $.ajax({
            url : "{% url 'viajes.views.resultsPerfil' %}", 
            type : "POST", 
            data : { pk : pk }, 
            success : function(json) {
                 document.getElementById("todosPriv").disabled=false;
                if( json.catModEco_A == true){
                    document.getElementById("id_catModEco_A").checked=true;
                }else{ document.getElementById("id_catModEco_A").checked=false;}  
                if( json.catModEco_B == true){
                    document.getElementById("id_catModEco_B").checked=true;
                }else{ document.getElementById("id_catModEco_B").checked=false;}  
                if( json.catModEco_M == true){
                    document.getElementById("id_catModEco_M").checked=true;
                }else{ document.getElementById("id_catModEco_M").checked=false;} 
                      
            },

            error : function(xhr,errmsg,err) {

                $("input:checked").each(function() {
                     $(this).attr("checked",false);
                });
                document.getElementById("todosPriv").disabled=true; 
                alert("Por favor seleccione un usuario");
            }
        });
	




});

function seleccionar_todo(){
   for (i=0;i<document.f1.elements.length;i++)
      if(document.f1.elements[i].type == "checkbox")
         document.f1.elements[i].checked=1
} 


{% endblock %}
