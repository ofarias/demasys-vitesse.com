{% extends 'base.html' %}
{% load i18n %}
{% load sepomex_filters %}
{% load url from future %}
{% load bootstrap_pagination %}

{% block title %}Clientes{% endblock %}
{% block content_title %} Catálogo de Clientes{% endblock %}

{% block nav-clientes %}<li class="active">{% endblock %}

{% block breadcrumb %}
<ul class="page-breadcrumb">
	<li>
		<i class="fa fa-home"></i>
		<a href="{% url 'dashboards.views.index' %}">Dashboard</a>	
		<i class="fa fa-angle-right"></i>					
	</li>
	<li>		
		<a href="#">Clientes</a>						
	</li>	
</ul>
{% endblock %}

{% block actions %}
{% endblock %}

{% block content %}
							<div class="modal fade" id="ajax" role="basic" aria-hidden="true">
								<div class="page-loading page-loading-boxed">
									<img src="{{MEDIA_URL}}img/loading-spinner-grey.gif" alt="" class="loading">
									<span>
									&nbsp;&nbsp;Cargando... </span>
								</div>
								<div class="modal-dialog">
									<div class="modal-content">
									</div>
								</div>
							</div>
							<div class="modal fade" id="ajax2" role="basic" aria-hidden="true">
								<div class="page-loading page-loading-boxed">
									<img src="{{MEDIA_URL}}img/loading-spinner-grey.gif" alt="" class="loading">
									<span>
									&nbsp;&nbsp;Cargando... </span>
								</div>
								<div class="modal-dialog">
									<div class="modal-content">
									</div>
								</div>
							</div>

		<div class="row">
            <div class="col-md-12">
				<div class="portlet box grey-cascade">
						<div class="portlet-title">
							<div class="caption">
								Listado de clientes
							</div>							
						</div>
						<div class="portlet-body">
							<div class="table-toolbar">
								<div class="row">
									<div class="col-md-6">
										<div class="btn-group">
								{% if perms.clientes.add_cliente %}
								<a href="{% url 'clientes.views.agregar' %}" class="btn blue">
											Agregar nuevo <i class="fa fa-plus"></i>
											</a>
								{% else %}
								<div class="alert alert-dismissable alert-danger">
									<button class="close" aria-hidden="true" data-dismiss="alert" type="button"></button>
									{{user.get_short_name}} no tiene permisos para Agregar.<br/> Solicite permisos al administrador.
								</div>
								{% endif %}

											
										</div>
									</div>
									<div class="col-md-6">
										
									</div>
								</div>
							</div>
							<div class="table-scrollable">
								<table class="table table-striped table-bordered table-hover" id="sample_1">
								<thead>
								<tr>
									<th>
										 Nombre
									</th>
									<th>
										 Delegación/Municipio
									</th>
									<th>
										 Colonia
									</th>									
									<th>
										 Departamentos
									</th>
									<th>
										 Editar
									</th>								
								</tr>
								</thead>
								<tbody>
								{% for cliente in clientes %}
								<tr class="odd gradeX">
									<td>
										{{cliente.nombre}}
									</td>
									<td>
										{{cliente.facturacion_clave_municipio|municipio}}
									</td>
									<td>
										{{cliente.facturacion_colonia}}
									</td>									
									<td>
										 <a href="{% url 'clientes.views.departamentos' cliente.pk %}" data-target="#ajax" data-toggle="modal">Ver departamentos</a>
									</td>
									<td>
								{% if perms.clientes.change_cliente %}
									<a href="{% url 'clientes.views.editar' cliente.pk %}" class="btn default btn-xs blue-stripe">Editar</a>
								{% else %}
								<div class="alert alert-dismissable alert-danger">
									<button class="close" aria-hidden="true" data-dismiss="alert" type="button"></button>
									{{user.get_short_name}} no tiene permisos para Editar.<br/> Solicite permisos al administrador.
								</div>
								{% endif %}
										 
									</td>
								</tr>
								{% empty %}
								<tr>
									<td colspan="6" class="center">No se encontrarón datos.</td>
								</tr>
								{% endfor %}							
								</tbody>
								</table>
								{% bootstrap_paginate clientes %}
							</div>
						</div>
					</div>					
            </div>
         </div>
{% endblock %}

{% block script_ready %}
	$('body').on('hidden.bs.modal', '.modal', function () {
  		$(this).removeData('bs.modal');
	});
{% endblock %}
